<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SPLIT - Dividir por Itens</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      background: #1a1919;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px 0;
    }
    .titulo {
      font-size: 3em;
      color: #00ff00;
      margin-bottom: 30px;
      
    }
    .input-container {
      background: #00cc33;
      border-radius: 30px;
      padding: 15px;
      margin: 0 auto 30px auto;
      display: inline-block;
    }
    .input-container input {
      font-size: 18px;
      padding: 5px 10px;
      border-radius: 10px;
      border: none;
      background: #222;
      color: #fff;
      margin-left: 10px;
    }
    .pessoas-itens {
      max-width: 400px;
      margin: 0 auto;
      padding: 0;
      list-style: none;
    }
    .pessoa-bloco {
      background: none;
      margin-bottom: 30px;
      padding: 0;
    }
    .nome-pessoa {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
      margin-bottom: 10px;
    }
    .nome-pessoa input {
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 10px;
      border: none;
      background: #222;
      color: #fff;
      padding: 5px 10px;
      text-align: center;
      width: 120px;
    }
    .resultado-pessoa {
      margin-left: 20px;
      color: #00ff00;
      font-weight: bold;
      font-size: 1.1em;
      min-width: 90px;
      text-align: left;
      display: inline-block;
    }
    .itens-botoes {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 10px;
    }
    .item-btn {
      background: #00cc33;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      color: #fff;
      font-size: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
      position: relative;
    }
    .item-btn:hover {
      background: #00ff00;
      color: #1a1919;
    }
    .input-valor-item {
      margin-left: 8px;
      width: 70px;
      border-radius: 8px;
      border: none;
      padding: 3px 8px;
      font-size: 16px;
      background: #222;
      color: #fff;
      outline: 2px solid #00cc33;
    }
    .itens-lista {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 10px;
    }
    .item-icone {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 18px;
      color: #fff;
    }
    .item-icone .icone-circulo {
      background: #00cc33;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      font-size: 28px;
      margin-bottom: 2px;
    }
    .item-icone .quantidade {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #222;
      color: #fff;
      border-radius: 50%;
      font-size: 15px;
      min-width: 18px;
      min-height: 18px;
      padding: 0 4px;
      text-align: center;
      font-weight: bold;
      border: 2px solid #00cc33;
      z-index: 2;
    }
    .adicionar-pessoa-btn {
      background: #00cc33;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      color: #fff;
      font-size: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      margin: 30px auto 0 auto;
      transition: background 0.2s;
    }
    .adicionar-pessoa-btn:hover {
      background: #00ff00;
      color: #1a1919;
    }
    .calcular-btn {
  background: #00cc33;
  color: #fff;
  border: none;
  border-radius: 40px;
  height: 70px;               /* Altura fixa */
  width: 250px;               /* Largura fixa ou ajuste conforme necessário */
  font-size: 1.8em;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.2s;
  display: flex;
  align-items: center;        /* Centraliza verticalmente */
  justify-content: center;    /* Centraliza horizontalmente */
  margin: 30px auto 0 auto;
  text-align: center;
  line-height: 1;
  padding: 0 20px;
  box-sizing: border-box;     /* Garante que padding não estoure largura/altura */
  white-space: nowrap;        /* Evita quebra do texto */
}

    .calcular-btn:hover {
      background: #00ff00;
      color: #1a1919;
    }
   .remover-pessoa {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: #222;
  border-radius: 50%;
  padding: 4px;
  border: 2px solid #222;
  font-size: 16px;
  transition: background 0.3s ease, transform 0.2s ease;
  cursor: pointer;
  margin-left: 10px;
}

.remover-pessoa i {
  color: #00cc33;
  transition: color 0.3s ease;
}

.remover-pessoa:hover {
  background-color: #00cc33;
  transform: scale(1.1);
}

.remover-pessoa:hover i {
  color: #fff;
}




  </style>
</head>
<body>
  <div class="titulo">SPLIT</div>
  <div class="input-container">
    <label for="valorConta">VALOR DA CONTA:</label>
    <!-- ✅ Campo de valor da conta + botão 10% lado a lado -->
<div style="display: flex; align-items: center; gap: 10px; justify-content: center; margin-bottom: 20px;">
  <input type="number" id="valorConta" class="campo" placeholder="Valor da Conta">

  <!-- ✅ Botão 10% -->
  <button id="botaoDezPorCento" class="botao">10%</button>
</div>

  </div>
  <ul id="pessoasItens" class="pessoas-itens">
    <!-- Pessoas serão adicionadas aqui -->
  </ul>
  <button id="adicionarPessoa" class="adicionar-pessoa-btn"><i class="fas fa-plus"></i></button>
  <button id="calcular" class="calcular-btn">CALCULAR</button>
  <div id="resultado" class="resultado"></div>
<script>
  const pessoasItens = document.getElementById('pessoasItens');

  document.getElementById('adicionarPessoa').onclick = function () {
    const li = document.createElement('li');
    li.className = 'pessoa-bloco';

    li.innerHTML = `
      <div class="nome-pessoa">
        <i class="fas fa-user-circle" style="font-size:40px;color:#00cc33"></i>
        <input type="text" placeholder="Nome" value="">
        <span class="resultado-pessoa"></span>
        <span class="lixeira-icone remover-pessoa" title="Remover pessoa">
          <i class="fas fa-trash"></i>
        </span>
      </div>
      <div class="itens-botoes">
        <button class="item-btn" data-tipo="bebida" title="Adicionar bebida"><i class="fas fa-champagne-glasses"></i></button>
        <button class="item-btn" data-tipo="comida" title="Adicionar comida"><i class="fas fa-utensils"></i></button>
        <button class="item-btn" data-tipo="doce" title="Adicionar doce"><i class="fas fa-cake"></i></button>
      </div>
      <div class="itens-lista"></div>
    `;

    pessoasItens.appendChild(li);

    // ✅ Corrigido: agora seleciona corretamente o botão de remover pessoa
    li.querySelector('.remover-pessoa').onclick = function () {
      li.remove();
    };

    li.querySelectorAll('.item-btn').forEach(btn => {
      btn.onclick = function () {
        const tipo = btn.getAttribute('data-tipo');
        if (btn.parentElement.querySelector('.input-valor-item')) return;

        const input = document.createElement('input');
        input.type = 'number';
        input.min = '0.01';
        input.step = '0.01';
        input.placeholder = 'Valor';
        input.className = 'input-valor-item';

        btn.parentElement.insertBefore(input, btn.nextSibling);
        input.focus();

        function finalizar() {
          const valor = parseFloat(input.value.replace(',', '.'));
          if (!isNaN(valor) && valor > 0) {
            adicionarItem(li.querySelector('.itens-lista'), tipo, valor);
          }
          input.remove();
        }

        input.addEventListener('blur', finalizar);
        input.addEventListener('keydown', function (e) {
          if (e.key === 'Enter') {
            finalizar();
          }
        });
      };
    });
  };

  function adicionarItem(container, tipo, valor) {
    let icone;
    if (tipo === 'bebida') {
      icone = '<i class="fas fa-champagne-glasses icone"></i>';
    } else if (tipo === 'comida') {
      icone = '<i class="fas fa-utensils icone"></i>';
    } else {
      icone = '<i class="fas fa-cake icone"></i>';
    }

    let itemDiv = container.querySelector(`.item-icone[data-tipo="${tipo}"]`);
    if (!itemDiv) {
      itemDiv = document.createElement('div');
      itemDiv.className = 'item-icone';
      itemDiv.setAttribute('data-tipo', tipo);
      itemDiv.dataset.valores = JSON.stringify([valor]);
      itemDiv.innerHTML = `
        <span class="icone-circulo" style="position:relative;">
          ${icone}
          <span class="quantidade">1</span>
        </span>
        <span class="lixeira-icone" style="margin-top:2px;cursor:pointer;position:static;">
          <i class="fas fa-trash"></i>
        </span>
        <span class="valor-total">${valor.toFixed(2).replace('.', ',')}</span>
      `;
      container.appendChild(itemDiv);

      itemDiv.querySelector('.lixeira-icone').onclick = function (e) {
        e.stopPropagation();
        removerUltimoValor(itemDiv);
      };
    } else {
      let valores = JSON.parse(itemDiv.dataset.valores);
      valores.push(valor);
      itemDiv.dataset.valores = JSON.stringify(valores);
      let qtd = valores.length;
      let valAtual = valores.reduce((a, b) => a + b, 0);
      itemDiv.querySelector('.quantidade').textContent = qtd;
      itemDiv.querySelector('.valor-total').textContent = valAtual.toFixed(2).replace('.', ',');
    }
  }

  function removerUltimoValor(itemDiv) {
    let valores = JSON.parse(itemDiv.dataset.valores);
    if (valores.length > 1) {
      valores.pop();
      itemDiv.dataset.valores = JSON.stringify(valores);
      itemDiv.querySelector('.quantidade').textContent = valores.length;
      let valAtual = valores.reduce((a, b) => a + b, 0);
      itemDiv.querySelector('.valor-total').textContent = valAtual.toFixed(2).replace('.', ',');
    } else {
      itemDiv.remove();
    }
  }

  function calcularDivisao(comGorjeta = false) {
    const pessoas = document.querySelectorAll('.pessoa-bloco');
    let totaisIndividuais = [];
    let totalGeral = 0;

    pessoas.forEach(pessoa => {
      let total = 0;
      pessoa.querySelectorAll('.item-icone').forEach(item => {
        const valores = JSON.parse(item.dataset.valores);
        total += valores.reduce((a, b) => a + b, 0);
      });
      totaisIndividuais.push(total);
      totalGeral += total;
    });

    let gorjetaPorPessoa = 0;
    if (comGorjeta && pessoas.length > 0) {
      const gorjetaTotal = totalGeral * 0.10;
      gorjetaPorPessoa = gorjetaTotal / pessoas.length;
    }

    totaisIndividuais.forEach((total, index) => {
      const pessoa = pessoas[index];
      const totalFinal = total + gorjetaPorPessoa;
      pessoa.querySelector('.resultado-pessoa').textContent = `R$ ${totalFinal.toFixed(2).replace('.', ',')}`;
    });

    const totalFinalGeral = totalGeral + (comGorjeta ? totalGeral * 0.10 : 0);
    document.getElementById('resultado').innerHTML = `Total geral ${comGorjeta ? 'com' : 'sem'} gorjeta: R$ ${totalFinalGeral.toFixed(2).replace('.', ',')}`;
  }

  document.getElementById('calcular').onclick = function () {
    calcularDivisao(false);
  };

  document.getElementById("botaoDezPorCento").onclick = function () {
    calcularDivisao(true);
  };
</script>


</body>
</html>